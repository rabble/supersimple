(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[812],{1104:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/pending-listings",function(){return i(7267)}])},4820:function(e,t,i){"use strict";i.d(t,{Z:function(){return o}});var r=i(5893);i(7294);var s=i(9008),n=i.n(s),a=i(1664),c=i.n(a);function o(e){let{children:t,title:i="SuperSimple.Directory",description:s="A platform for creating and managing directories",showHeader:a=!1,directoryId:o,directoryName:d}=e;return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsxs)(n(),{children:[(0,r.jsx)("title",{children:i}),(0,r.jsx)("meta",{name:"description",content:s}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),a&&o&&(0,r.jsx)("nav",{className:"bg-gray-100 border-b border-gray-200",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:d||"Directory"})})}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("div",{className:"hidden md:ml-6 md:flex md:space-x-8",children:[(0,r.jsx)(c(),{href:"/directories/".concat(o,"/listings"),className:"text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium",children:"Organizations"}),(0,r.jsx)(c(),{href:"/about",className:"text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium",children:"About"}),(0,r.jsx)(c(),{href:"/contact",className:"text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium",children:"Contact"})]})})]})})}),(0,r.jsx)("main",{children:t}),a&&(0,r.jsx)("footer",{className:"bg-gray-100 border-t border-gray-200 mt-12",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wider mb-4",children:"Directory"}),(0,r.jsx)("ul",{className:"space-y-2",children:o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("li",{children:(0,r.jsx)(c(),{href:"/directories/".concat(o),className:"text-gray-600 hover:text-indigo-600",children:"Home"})}),(0,r.jsx)("li",{children:(0,r.jsx)(c(),{href:"/directories/".concat(o,"/listings"),className:"text-gray-600 hover:text-indigo-600",children:"Browse Listings"})}),(0,r.jsx)("li",{children:(0,r.jsx)(c(),{href:"/directories/".concat(o,"/submit"),className:"text-gray-600 hover:text-indigo-600",children:"Add Listing"})})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wider mb-4",children:"About"}),(0,r.jsxs)("ul",{className:"space-y-2",children:[(0,r.jsx)("li",{children:(0,r.jsx)(c(),{href:"/about",className:"text-gray-600 hover:text-indigo-600",children:"About Us"})}),(0,r.jsx)("li",{children:(0,r.jsx)(c(),{href:"/contact",className:"text-gray-600 hover:text-indigo-600",children:"Contact"})}),(0,r.jsx)("li",{children:(0,r.jsx)(c(),{href:"/comparisons",className:"text-gray-600 hover:text-indigo-600",children:"Comparisons"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wider mb-4",children:"Legal"}),(0,r.jsxs)("ul",{className:"space-y-2",children:[(0,r.jsx)("li",{children:(0,r.jsx)(c(),{href:"/terms",className:"text-gray-600 hover:text-indigo-600",children:"Terms of Use"})}),(0,r.jsx)("li",{children:(0,r.jsx)(c(),{href:"/privacy",className:"text-gray-600 hover:text-indigo-600",children:"Privacy Policy"})})]})]})]}),(0,r.jsx)("div",{className:"mt-8 pt-8 border-t border-gray-200 text-center",children:(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["\xa9 ",new Date().getFullYear()," SuperSimple.Directory. All rights reserved."]})})]})})]})}},7644:function(e,t,i){"use strict";i.d(t,{GJ:function(){return a},i4:function(){return s}});var r,s,n=i(9814);async function a(e){if(!e)return!1;try{var t;let i=null===(t=e.user_metadata)||void 0===t?void 0:t.role;if("admin"===i)return!0;try{let{data:t,error:i}=await n.O.from("user_roles").select("role").eq("user_id",e.id).single();if(i){if("42P01"===i.code||"42P17"===i.code){if(console.warn("Database error (".concat(i.code,"): ").concat(i.message)),"68a14571-a988-45a4-b023-0d701ae034f4"===e.id)return console.log("Using hardcoded admin check for initial user"),!0;return!1}return console.error("Error checking admin status:",i),!1}return(null==t?void 0:t.role)==="admin"}catch(e){return console.error("Database error checking admin status:",e),!1}}catch(e){return console.error("Unexpected error checking admin status:",e),!1}}(r=s||(s={})).ADMIN="admin",r.CONTRIBUTOR="contributor",r.VIEWER="viewer"},9814:function(e,t,i){"use strict";i.d(t,{O:function(){return r}});let r=(0,i(6490).eI)("https://mzbodrwzhasiydvpvbid.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im16Ym9kcnd6aGFzaXlkdnB2YmlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA3MjA0NDAsImV4cCI6MjA1NjI5NjQ0MH0.4PtrUzyD5AUZzWqoWYpgMFlojhW2y9SH6-tPvahPxSo")},7267:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return l}});var r=i(5893),s=i(7294),n=i(1163),a=i(9814),c=i(3700),o=i(7644),d=i(4820);function l(){let{user:e}=(0,c.a)(),t=(0,n.useRouter)(),[i,l]=(0,s.useState)(!0),[x,h]=(0,s.useState)(!1),[m,u]=(0,s.useState)([]),[g,p]=(0,s.useState)({});async function f(){try{let{data:e,error:t}=await a.O.from("directories").select("id, name");if(t)throw t;let i=(e||[]).reduce((e,t)=>(e[t.id]=t.name,e),{});p(i);let{data:r,error:s}=await a.O.from("listings").select("*").eq("status","pending").order("created_at",{ascending:!1});if(s)throw s;let n=(r||[]).map(e=>({...e,directory_name:i[e.directory_id]||"Unknown Directory"}));u(n)}catch(e){console.error("Error fetching pending listings:",e)}}async function j(e){try{let t=await fetch("/api/listings/".concat(e,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"approved"})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to approve listing")}u(m.filter(t=>t.id!==e))}catch(e){console.error("Error approving listing:",e)}}async function y(e){try{let t=await fetch("/api/listings/".concat(e,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"rejected"})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to reject listing")}u(m.filter(t=>t.id!==e))}catch(e){console.error("Error rejecting listing:",e)}}return((0,s.useEffect)(()=>{(async function(){if(!e){t.push("/auth/login");return}try{let i=await (0,o.GJ)(e);if(h(i),!i){t.push("/dashboard");return}f()}catch(e){console.error("Error checking admin status:",e)}finally{l(!1)}})()},[e,t]),i)?(0,r.jsx)(d.Z,{title:"Admin - Pending Listings",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Loading..."})})}):x?(0,r.jsx)(d.Z,{title:"Admin - Pending Listings",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Pending Listings"}),0===m.length?(0,r.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,r.jsx)("p",{children:"No pending listings found."})}):(0,r.jsx)("div",{className:"space-y-6",children:m.map(e=>{var t,i,s;return(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"mb-4 pb-4 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:(null===(t=e.data)||void 0===t?void 0:t.name)||(null===(i=e.data)||void 0===i?void 0:i.title)||"Unnamed Listing"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Directory: ",e.directory_name," | Submitted: ",new Date(e.created_at).toLocaleDateString()]})]}),(0,r.jsx)("div",{className:"mb-6",children:(s=e.data)?(0,r.jsx)("div",{className:"space-y-2",children:Object.entries(s).map(e=>{let[t,i]=e;return(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,r.jsxs)("span",{className:"font-medium text-gray-700",children:[t,":"]}),(0,r.jsx)("span",{className:"col-span-2",children:"object"==typeof i?JSON.stringify(i):String(i)})]},t)})}):(0,r.jsx)("p",{children:"No data available"})}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{onClick:()=>j(e.id),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500",children:"Approve"}),(0,r.jsx)("button",{onClick:()=>y(e.id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Reject"})]})]},e.id)})})]})}):(0,r.jsx)(d.Z,{title:"Access Denied",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Access Denied"}),(0,r.jsx)("p",{children:"You do not have permission to view this page."})]})})}},9008:function(e,t,i){e.exports=i(3867)},1163:function(e,t,i){e.exports=i(3079)}},function(e){e.O(0,[664,888,774,179],function(){return e(e.s=1104)}),_N_E=e.O()}]);